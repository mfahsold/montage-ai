---
# =============================================================================
# NFS Persistent Volumes for Montage AI
# =============================================================================
# Enables multi-node GPU access for distributed rendering.
# UPDATE the NFS server address below for your environment.
#
# Prerequisites:
#   - NFS server (update NFS_SERVER below)
#   - Exported paths: /mnt/nfs-montage/{input,music,output,assets}
#
# To create exports on NFS server:
#   sudo mkdir -p /mnt/nfs-montage/{input,music,output,assets}
#   sudo chown -R nobody:nogroup /mnt/nfs-montage
#   Add to /etc/exports:
#     /mnt/nfs-montage YOUR_NETWORK/24(rw,sync,no_subtree_check,no_root_squash)
#   sudo exportfs -ra
# =============================================================================

apiVersion: v1
kind: PersistentVolume
metadata:
  name: montage-ai-input-nfs
  labels:
    app.kubernetes.io/name: montage-ai
    storage-type: nfs
spec:
  capacity:
    storage: 100Gi
  accessModes:
    - ReadWriteMany
  nfs:
    server: NFS_SERVER_IP  # UPDATE: Your NFS server IP
    path: /mnt/nfs-montage/input
  mountOptions:
    - nfsvers=4.1
    - rsize=1048576
    - wsize=1048576
    - timeo=600
    - retrans=2
    - noatime
    - nodiratime
  persistentVolumeReclaimPolicy: Retain
---
apiVersion: v1
kind: PersistentVolume
metadata:
  name: montage-ai-music-nfs
  labels:
    app.kubernetes.io/name: montage-ai
    storage-type: nfs
spec:
  capacity:
    storage: 10Gi
  accessModes:
    - ReadWriteMany
  nfs:
    server: NFS_SERVER_IP  # UPDATE: Your NFS server IP
    path: /mnt/nfs-montage/music
  mountOptions:
    - nfsvers=4.1
    - rsize=1048576
    - wsize=1048576
    - timeo=600
    - retrans=2
    - noatime
    - nodiratime
  persistentVolumeReclaimPolicy: Retain
---
apiVersion: v1
kind: PersistentVolume
metadata:
  name: montage-ai-output-nfs
  labels:
    app.kubernetes.io/name: montage-ai
    storage-type: nfs
spec:
  capacity:
    storage: 100Gi
  accessModes:
    - ReadWriteMany
  nfs:
    server: NFS_SERVER_IP  # UPDATE: Your NFS server IP
    path: /mnt/nfs-montage/output
  mountOptions:
    - nfsvers=4.1
    - rsize=1048576
    - wsize=1048576
    - timeo=600
    - retrans=2
    - noatime
    - nodiratime
  persistentVolumeReclaimPolicy: Retain
---
apiVersion: v1
kind: PersistentVolume
metadata:
  name: montage-ai-assets-nfs
  labels:
    app.kubernetes.io/name: montage-ai
    storage-type: nfs
spec:
  capacity:
    storage: 10Gi
  accessModes:
    - ReadWriteMany
  nfs:
    server: NFS_SERVER_IP  # UPDATE: Your NFS server IP
    path: /mnt/nfs-montage/assets
  mountOptions:
    - nfsvers=4.1
    - rsize=1048576
    - wsize=1048576
    - timeo=600
    - retrans=2
    - noatime
    - nodiratime
  persistentVolumeReclaimPolicy: Retain
